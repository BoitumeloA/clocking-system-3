<!DOCTYPE html>
<html>
<head>
    <title>Icon Security – Attendance System</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { font-family: Arial, sans-serif; margin: 10px; }
        h1, h2, h3 { margin-bottom: 10px; }
        .box { border: 1px solid #ccc; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
        .camera-wrapper { position: relative; width: 100%; max-width: 400px; }
        video { width: 100%; border-radius: 5px; }
        #faceBox { position: absolute; border: 2px solid red; display: none; }
        .detected { border-color: green !important; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        table, th, td { border: 1px solid #ccc; padding: 5px; text-align: left; }
        button { padding: 5px 10px; margin: 5px 0; }
        .danger { background-color: #e74c3c; color: #fff; }
        #faceMessage { margin-top: 5px; font-weight: bold; }
    </style>
</head>
<body>

<h1>Icon Security – Attendance System</h1>

<!-- CAMERA VIEW -->
<div class="box face-box">
    <h3>Camera View</h3>
    <div class="camera-wrapper">
        <video id="camera" autoplay playsinline></video>
        <div id="faceBox"></div>
    </div>
    <div id="faceMessage">Waiting for face...</div>
</div>

<!-- EMPLOYEE REGISTRATION -->
<div class="box">
    <h2>Employee Registration</h2>
    <input type="text" id="empName" placeholder="Employee Name"><br><br>
    <input type="number" id="empCompanyNumber" placeholder="Company Number"><br><br>
    <input type="number" id="empPIN" placeholder="4-Digit PIN" maxlength="4"><br><br>
    <button onclick="registerFace()">Register Face & Save Employee</button>
</div>

<!-- ADMIN PANEL -->
<div class="box">
    <button onclick="adminLogin()">Admin Login</button>

    <div class="adminPanel" id="adminPanel" style="display:none;">
        <h2>Admin Panel</h2>

        <h3>Employee List</h3>
        <table id="employeeTable">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Company Number</th>
                    <th>PIN</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <h3>Monthly Summary</h3>
        <div id="summaryBox"></div>

        <h3>Attendance Records</h3>
        <table id="recordTable">
            <thead>
                <tr>
                    <th>Employee</th>
                    <th>Date</th>
                    <th>Clock In</th>
                    <th>Clock Out</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <button onclick="downloadCSV()">Download CSV</button>
        <button onclick="exportPDF()">Export Monthly PDF</button><br><br>
        <button onclick="clearAllData()" class="danger">Clear All Data</button>
    </div>
</div>

<!-- Face API + jsPDF -->
<script src="https://unpkg.com/face-api.js@0.22.2/dist/face-api.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="script.js"></script>
</body>
</html>